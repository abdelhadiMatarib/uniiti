/* 
jQuery easyDrag
http://www.gildasp.fr/exp/easydrag/

by Gildas P. / www.gildasp.fr/playingwithpixels 
Le 17/12/2012
*/
function easyDrag_moveEvent(e,t,n,r,i){dragItem=t.data("myDragItem");dragHandle=t;dragHandle.data("startFunc").call(dragItem);easyDrag_decaleX=r-dragItem.offset().left;easyDrag_decaleY=i-dragItem.offset().top;easyDrag_Axis=t.data("axis");easyDrag_Container=t.data("container");easyDrag_dragFunc=dragHandle.data("dragFunc");easyDrag_origX=dragHandle.data("origX");easyDrag_origY=dragHandle.data("origY");if(n=="mouse"){$(document).bind("mousemove",function(e){e.preventDefault();easyDrag_dragFunc.call(dragItem);easyDrag_nextX=e.pageX-easyDrag_decaleX-easyDrag_origX;easyDrag_contain("h");if(!easyDrag_Axis||easyDrag_Axis=="x"){dragItem.css("left",easyDrag_nextX+"px")}easyDrag_nextY=e.pageY-easyDrag_decaleY-easyDrag_origY;easyDrag_contain("y");if(!easyDrag_Axis||easyDrag_Axis=="y"){dragItem.css("top",easyDrag_nextY+"px")}})}else{$(document).bind("touchmove",function(e){e.preventDefault();touch=e.originalEvent.changedTouches[0];easyDrag_dragFunc.call(dragItem);easyDrag_nextX=touch.pageX-easyDrag_decaleX-easyDrag_origX;easyDrag_contain("h");if(!easyDrag_Axis||easyDrag_Axis=="x"){dragItem.css("left",easyDrag_nextX+"px")}easyDrag_nextY=touch.pageY-easyDrag_decaleY-easyDrag_origY;easyDrag_contain("y");if(!easyDrag_Axis||easyDrag_Axis=="y"){dragItem.css("top",easyDrag_nextY+"px")}})}easyDrag_maxZindex++;dragItem.css("z-index",easyDrag_maxZindex)}function easyDrag_contain(e){if(e=="h"){if(easyDrag_Container&&easyDrag_Container.length>0){limite1=easyDrag_Container.offset().left-easyDrag_origX;limite2=limite1+easyDrag_Container.width()-dragItem.innerWidth();limite1+=parseInt(dragItem.css("margin-left"));if(easyDrag_nextX<limite1){easyDrag_nextX=limite1}if(easyDrag_nextX>limite2){easyDrag_nextX=limite2}}}else{if(easyDrag_Container&&easyDrag_Container.length>0){limite1=easyDrag_Container.offset().top-easyDrag_origY;limite2=limite1+easyDrag_Container.height()-dragItem.innerHeight();limite1+=parseInt(dragItem.css("margin-top"));if(easyDrag_nextY<limite1){easyDrag_nextY=limite1}if(easyDrag_nextY>limite2){easyDrag_nextY=limite2}}}}(function(e){e.fn.easyDrag=function(t){t=e.extend({handle:"this",axis:false,container:false,start:function(){},drag:function(){},stop:function(){}},t);easyDrag_maxZindex=0;if(t.handle=="this"){handlers=this}else{handlers=this.find(t.handle)}handlers.css("cursor","move");easyDrag_maxZindex=0;this.each(function(){if(t.handle=="this"){handle=e(this)}else{handle=e(this).find(t.handle)}handle.data("myDragItem",e(this));handle.data("axis",t.axis);handle.data("container",t.container);handle.data("startFunc",t.start);handle.data("dragFunc",t.drag);handle.data("stopFunc",t.stop);if(e(this).css("z-index")!="auto"){easyDrag_maxZindex=Math.max(easyDrag_maxZindex,e(this).css("z-index"))}if(e(this).css("position")=="absolute"||e(this).css("position")=="fixed"){handle.data("origX",0);handle.data("origY",0)}else{handle.data("origX",e(this).offset().left);handle.data("origY",e(this).offset().top);e(this).css("position","relative")}});handlers.mousedown(function(t){t.preventDefault();easyDrag_moveEvent(t,e(this),"mouse",t.pageX,t.pageY);e(document).mouseup(function(){dragHandle.data("stopFunc").call(dragItem);e(document).unbind("mousemove mouseup")})});handlers.bind("touchstart",function(t){t.preventDefault();touch=t.originalEvent.changedTouches[0];easyDrag_moveEvent(t,e(this),"touch",touch.pageX,touch.pageY);e(document).bind("touchend",function(){dragHandle.data("stopFunc").call(dragItem);e(document).unbind("touchmove touchend")})});return this}})(jQuery)